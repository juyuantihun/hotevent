#!/usr/bin/env pwsh\n\nWrite-Host \"=== ğŸŒ å…¨é¢ç»çº¬åº¦ä¿®å¤éªŒè¯è„šæœ¬ ===\" -ForegroundColor Green\nWrite-Host \"éªŒè¯çƒ­ç‚¹äº‹ä»¶ç³»ç»Ÿä¸­æ‰€æœ‰ç»„ä»¶çš„åæ ‡ä¿®å¤æƒ…å†µ\" -ForegroundColor Cyan\nWrite-Host \"\"\n\n# æ£€æŸ¥æ˜¯å¦åœ¨æ­£ç¡®çš„ç›®å½•\nif (-not (Test-Path \"src/main/java/com/hotech/events/service/impl\")) {\n    Write-Host \"âŒ é”™è¯¯ï¼šè¯·åœ¨é¡¹ç›®æ ¹ç›®å½•è¿è¡Œæ­¤è„šæœ¬\" -ForegroundColor Red\n    exit 1\n}\n\n$totalChecks = 0\n$passedChecks = 0\n$failedChecks = 0\n\nfunction Test-FileContent {\n    param(\n        [string]$FilePath,\n        [string[]]$Patterns,\n        [string]$Description\n    )\n    \n    Write-Host \"ğŸ” æ£€æŸ¥ $Description...\" -ForegroundColor Yellow\n    \n    if (-not (Test-Path $FilePath)) {\n        Write-Host \"   âŒ æ–‡ä»¶ä¸å­˜åœ¨: $FilePath\" -ForegroundColor Red\n        return $false\n    }\n    \n    $content = Get-Content $FilePath -Raw\n    $foundPatterns = 0\n    \n    foreach ($pattern in $Patterns) {\n        if ($content -match $pattern) {\n            Write-Host \"   âœ… æ‰¾åˆ°: $pattern\" -ForegroundColor Green\n            $foundPatterns++\n        } else {\n            Write-Host \"   âŒ ç¼ºå°‘: $pattern\" -ForegroundColor Red\n        }\n    }\n    \n    $success = $foundPatterns -eq $Patterns.Count\n    if ($success) {\n        Write-Host \"   âœ… $Description æ£€æŸ¥é€šè¿‡ ($foundPatterns/$($Patterns.Count))\" -ForegroundColor Green\n    } else {\n        Write-Host \"   âŒ $Description æ£€æŸ¥å¤±è´¥ ($foundPatterns/$($Patterns.Count))\" -ForegroundColor Red\n    }\n    \n    return $success\n}\n\nWrite-Host \"ğŸ“‹ å¼€å§‹éªŒè¯å„ç»„ä»¶çš„åæ ‡ä¿®å¤æƒ…å†µ...\" -ForegroundColor Cyan\nWrite-Host \"\"\n\n# 1. éªŒè¯ EnhancedDeepSeekServiceImpl\nWrite-Host \"1ï¸âƒ£  éªŒè¯ API å“åº”è§£æä¿®å¤\" -ForegroundColor Blue\n$patterns1 = @(\n    \"latitude.*è§£æ\",\n    \"longitude.*è§£æ\", \n    \"setLatitude.*Number\",\n    \"setLongitude.*Number\",\n    \"Double\\.parseDouble.*String\",\n    \"è§£æçº¬åº¦å¤±è´¥\",\n    \"è§£æç»åº¦å¤±è´¥\"\n)\n$result1 = Test-FileContent -FilePath \"src/main/java/com/hotech/events/service/impl/EnhancedDeepSeekServiceImpl.java\" -Patterns $patterns1 -Description \"EnhancedDeepSeekServiceImpl ç»çº¬åº¦è§£æ\"\n$totalChecks++\nif ($result1) { $passedChecks++ } else { $failedChecks++ }\nWrite-Host \"\"\n\n# 2. éªŒè¯ FallbackDataGeneratorImpl\nWrite-Host \"2ï¸âƒ£  éªŒè¯å¤‡ç”¨æ•°æ®ç”Ÿæˆå™¨ä¿®å¤\" -ForegroundColor Blue\n$patterns2 = @(\n    \"getSimulatedCoordinatesForFallback\",\n    \"getCoordinatesForRegion\",\n    \"39\\.9042.*116\\.4074\", # åŒ—äº¬åæ ‡\n    \"31\\.2304.*121\\.4737\", # ä¸Šæµ·åæ ‡\n    \"setLatitude.*coordinates\",\n    \"setLongitude.*coordinates\"\n)\n$result2 = Test-FileContent -FilePath \"src/main/java/com/hotech/events/service/impl/FallbackDataGeneratorImpl.java\" -Patterns $patterns2 -Description \"FallbackDataGeneratorImpl åæ ‡ç”Ÿæˆ\"\n$totalChecks++\nif ($result2) { $passedChecks++ } else { $failedChecks++ }\nWrite-Host \"\"\n\n# 3. éªŒè¯ EventStorageServiceImpl\nWrite-Host \"3ï¸âƒ£  éªŒè¯äº‹ä»¶å­˜å‚¨æœåŠ¡ä¿®å¤\" -ForegroundColor Blue\n$patterns3 = @(\n    \"getTestCoordinates\",\n    \"setLatitude.*coordinates\",\n    \"setLongitude.*coordinates\",\n    \"testCoordinates\"\n)\n$result3 = Test-FileContent -FilePath \"src/main/java/com/hotech/events/service/impl/EventStorageServiceImpl.java\" -Patterns $patterns3 -Description \"EventStorageServiceImpl æµ‹è¯•åæ ‡\"\n$totalChecks++\nif ($result3) { $passedChecks++ } else { $failedChecks++ }\nWrite-Host \"\"\n\n# 4. éªŒè¯ FallbackStrategyServiceImplï¼ˆæ£€æŸ¥ç°æœ‰åæ ‡ï¼‰\nWrite-Host \"4ï¸âƒ£  éªŒè¯é™çº§ç­–ç•¥åæ ‡\" -ForegroundColor Blue\n$patterns4 = @(\n    \"setLatitude.*39\\.9042\",\n    \"setLongitude.*116\\.4074\",\n    \"setLatitude.*31\\.2304\",\n    \"setLongitude.*121\\.4737\"\n)\n$result4 = Test-FileContent -FilePath \"src/main/java/com/hotech/events/service/impl/FallbackStrategyServiceImpl.java\" -Patterns $patterns4 -Description \"FallbackStrategyServiceImpl é™çº§åæ ‡\"\n$totalChecks++\nif ($result4) { $passedChecks++ } else { $failedChecks++ }\nWrite-Host \"\"\n\n# 5. æ£€æŸ¥åæ ‡æ•°æ®å®Œæ•´æ€§\nWrite-Host \"5ï¸âƒ£  éªŒè¯åæ ‡æ•°æ®å®Œæ•´æ€§\" -ForegroundColor Blue\n\n# ç»Ÿè®¡é¢„å®šä¹‰çš„åŸå¸‚åæ ‡\n$allFiles = @(\n    \"src/main/java/com/hotech/events/service/impl/EnhancedDeepSeekServiceImpl.java\",\n    \"src/main/java/com/hotech/events/service/impl/FallbackDataGeneratorImpl.java\",\n    \"src/main/java/com/hotech/events/service/impl/EventStorageServiceImpl.java\"\n)\n\n$cities = @(\"åŒ—äº¬\", \"ä¸Šæµ·\", \"å¹¿å·\", \"æ·±åœ³\", \"æ­å·\", \"å—äº¬\", \"æ­¦æ±‰\", \"æˆéƒ½\", \"è¥¿å®‰\", \"é‡åº†\")\n$foundCities = 0\n\nforeach ($file in $allFiles) {\n    if (Test-Path $file) {\n        $content = Get-Content $file -Raw\n        foreach ($city in $cities) {\n            if ($content -match $city) {\n                $foundCities++\n                break\n            }\n        }\n    }\n}\n\nWrite-Host \"   ğŸ™ï¸  å‘ç°åŸå¸‚åæ ‡è¦†ç›–: $foundCities/$($allFiles.Count) ä¸ªæ–‡ä»¶\" -ForegroundColor $(if ($foundCities -ge 2) { \"Green\" } else { \"Yellow\" })\n$totalChecks++\nif ($foundCities -ge 2) { $passedChecks++ } else { $failedChecks++ }\nWrite-Host \"\"\n\n# 6. ç¼–è¯‘æ£€æŸ¥\nWrite-Host \"6ï¸âƒ£  ç¼–è¯‘æ£€æŸ¥\" -ForegroundColor Blue\nif (Get-Command \"mvn\" -ErrorAction SilentlyContinue) {\n    Write-Host \"   ğŸ”¨ æ­£åœ¨æ£€æŸ¥é¡¹ç›®ç¼–è¯‘...\" -ForegroundColor Cyan\n    $compileOutput = & mvn compile -q 2>&1\n    if ($LASTEXITCODE -eq 0) {\n        Write-Host \"   âœ… é¡¹ç›®ç¼–è¯‘æˆåŠŸ\" -ForegroundColor Green\n        $totalChecks++\n        $passedChecks++\n    } else {\n        Write-Host \"   âŒ é¡¹ç›®ç¼–è¯‘å¤±è´¥\" -ForegroundColor Red\n        Write-Host \"   ç¼–è¯‘é”™è¯¯: $compileOutput\" -ForegroundColor Red\n        $totalChecks++\n        $failedChecks++\n    }\n} else {\n    Write-Host \"   âš ï¸  Maven ä¸å¯ç”¨ï¼Œè·³è¿‡ç¼–è¯‘æ£€æŸ¥\" -ForegroundColor Yellow\n}\nWrite-Host \"\"\n\n# 7. ç”ŸæˆéªŒè¯æŠ¥å‘Š\nWrite-Host \"ğŸ“Š éªŒè¯ç»“æœæ±‡æ€»\" -ForegroundColor Magenta\nWrite-Host \"===================\" -ForegroundColor Magenta\nWrite-Host \"æ€»æ£€æŸ¥é¡¹ç›®: $totalChecks\" -ForegroundColor White\nWrite-Host \"é€šè¿‡æ£€æŸ¥: $passedChecks\" -ForegroundColor Green\nWrite-Host \"å¤±è´¥æ£€æŸ¥: $failedChecks\" -ForegroundColor Red\n\n$successRate = if ($totalChecks -gt 0) { [math]::Round(($passedChecks / $totalChecks) * 100, 2) } else { 0 }\nWrite-Host \"æˆåŠŸç‡: $successRate%\" -ForegroundColor $(if ($successRate -ge 80) { \"Green\" } elseif ($successRate -ge 60) { \"Yellow\" } else { \"Red\" })\nWrite-Host \"\"\n\n# 8. æä¾›æµ‹è¯•å»ºè®®\nWrite-Host \"ğŸ§ª ä¸‹ä¸€æ­¥æµ‹è¯•å»ºè®®\" -ForegroundColor Cyan\nWrite-Host \"==================\" -ForegroundColor Cyan\n\nif ($passedChecks -eq $totalChecks) {\n    Write-Host \"ğŸ‰ æ‰€æœ‰æ£€æŸ¥éƒ½é€šè¿‡äº†ï¼å»ºè®®è¿›è¡Œä»¥ä¸‹æµ‹è¯•ï¼š\" -ForegroundColor Green\n    Write-Host \"   1. é‡å¯ Spring Boot åº”ç”¨\" -ForegroundColor White\n    Write-Host \"   2. åˆ›å»ºæ–°çš„æ—¶é—´çº¿å¹¶æ£€æŸ¥åæ ‡\" -ForegroundColor White\n    Write-Host \"   3. éªŒè¯æ•°æ®åº“ä¸­çš„åæ ‡æ•°æ®\" -ForegroundColor White\n    Write-Host \"   4. æµ‹è¯• API å“åº”åŒ…å«åæ ‡ä¿¡æ¯\" -ForegroundColor White\n} else {\n    Write-Host \"âš ï¸  éƒ¨åˆ†æ£€æŸ¥æœªé€šè¿‡ï¼Œå»ºè®®ï¼š\" -ForegroundColor Yellow\n    Write-Host \"   1. æ£€æŸ¥å¤±è´¥çš„ç»„ä»¶å¹¶é‡æ–°ä¿®å¤\" -ForegroundColor White\n    Write-Host \"   2. ç¡®è®¤ä»£ç ä¿®æ”¹å·²æ­£ç¡®ä¿å­˜\" -ForegroundColor White\n    Write-Host \"   3. é‡æ–°è¿è¡ŒéªŒè¯è„šæœ¬\" -ForegroundColor White\n}\nWrite-Host \"\"\n\n# 9. æ•°æ®åº“éªŒè¯ SQL\nWrite-Host \"ğŸ—„ï¸  æ•°æ®åº“éªŒè¯ SQL\" -ForegroundColor Cyan\nWrite-Host \"==================\" -ForegroundColor Cyan\nWrite-Host \"-- æ£€æŸ¥æœ€æ–°äº‹ä»¶çš„åæ ‡ä¿¡æ¯\" -ForegroundColor Gray\nWrite-Host \"SELECT id, event_title, event_location, latitude, longitude, created_at\" -ForegroundColor Gray\nWrite-Host \"FROM event WHERE created_at >= DATE_SUB(NOW(), INTERVAL 10 MINUTE)\" -ForegroundColor Gray\nWrite-Host \"ORDER BY created_at DESC LIMIT 10;\" -ForegroundColor Gray\nWrite-Host \"\" -ForegroundColor Gray\nWrite-Host \"-- ç»Ÿè®¡åæ ‡è¦†ç›–ç‡\" -ForegroundColor Gray\nWrite-Host \"SELECT \" -ForegroundColor Gray\nWrite-Host \"    COUNT(*) as total_events,\" -ForegroundColor Gray\nWrite-Host \"    COUNT(CASE WHEN latitude IS NOT NULL AND longitude IS NOT NULL THEN 1 END) as events_with_coordinates,\" -ForegroundColor Gray\nWrite-Host \"    ROUND(COUNT(CASE WHEN latitude IS NOT NULL AND longitude IS NOT NULL THEN 1 END) * 100.0 / COUNT(*), 2) as coverage_percentage\" -ForegroundColor Gray\nWrite-Host \"FROM event;\" -ForegroundColor Gray\nWrite-Host \"\"\n\n# 10. API æµ‹è¯•å‘½ä»¤\nWrite-Host \"ğŸŒ API æµ‹è¯•å‘½ä»¤\" -ForegroundColor Cyan\nWrite-Host \"===============\" -ForegroundColor Cyan\nWrite-Host \"# åˆ›å»ºæµ‹è¯•æ—¶é—´çº¿\" -ForegroundColor Gray\nWrite-Host \"curl -X POST 'http://localhost:8080/api/timeline/generate' \\\\\" -ForegroundColor Gray\nWrite-Host \"  -H 'Content-Type: application/json' \\\\\" -ForegroundColor Gray\nWrite-Host \"  -d '{\\\"name\\\": \\\"åæ ‡æµ‹è¯•\\\", \\\"regionIds\\\": [1], \\\"keyword\\\": \\\"æµ‹è¯•\\\"}'\" -ForegroundColor Gray\nWrite-Host \"\" -ForegroundColor Gray\nWrite-Host \"# æµ‹è¯•åœ°ç†ä¿¡æ¯å¢å¼º\" -ForegroundColor Gray\nWrite-Host \"curl -X POST 'http://localhost:8080/api/geographic-enhancement/enhance-missing?limit=10'\" -ForegroundColor Gray\nWrite-Host \"\" -ForegroundColor Gray\nWrite-Host \"# æµ‹è¯•å¤‡ç”¨æ•°æ®ç”Ÿæˆ\" -ForegroundColor Gray\nWrite-Host \"curl -X POST 'http://localhost:8080/api/fallback/generate-test-events' \\\\\" -ForegroundColor Gray\nWrite-Host \"  -H 'Content-Type: application/json' \\\\\" -ForegroundColor Gray\nWrite-Host \"  -d '{\\\"theme\\\": \\\"æµ‹è¯•\\\", \\\"count\\\": 5}'\" -ForegroundColor Gray\nWrite-Host \"\"\n\n# 11. æ‰“å¼€æµ‹è¯•é¡µé¢\nif (Test-Path \"test-all-coordinate-fixes.html\") {\n    Write-Host \"ğŸ“„ æ­£åœ¨æ‰“å¼€è¯¦ç»†æµ‹è¯•æŒ‡å—...\" -ForegroundColor Yellow\n    try {\n        Start-Process \"test-all-coordinate-fixes.html\"\n        Write-Host \"   âœ… æµ‹è¯•æŒ‡å—é¡µé¢å·²æ‰“å¼€\" -ForegroundColor Green\n    } catch {\n        Write-Host \"   âš ï¸  æ— æ³•è‡ªåŠ¨æ‰“å¼€é¡µé¢ï¼Œè¯·æ‰‹åŠ¨æ‰“å¼€ test-all-coordinate-fixes.html\" -ForegroundColor Yellow\n    }\n}\n\n# 12. æœ€ç»ˆçŠ¶æ€\nWrite-Host \"\"\nWrite-Host \"=== éªŒè¯å®Œæˆ ===\" -ForegroundColor Green\n\nif ($passedChecks -eq $totalChecks) {\n    Write-Host \"ğŸ¯ çŠ¶æ€: æ‰€æœ‰ä¿®å¤éªŒè¯é€šè¿‡\" -ForegroundColor Green\n    Write-Host \"ğŸš€ å»ºè®®: å¯ä»¥å¼€å§‹åŠŸèƒ½æµ‹è¯•\" -ForegroundColor Green\n} elseif ($successRate -ge 80) {\n    Write-Host \"âš¡ çŠ¶æ€: å¤§éƒ¨åˆ†ä¿®å¤éªŒè¯é€šè¿‡\" -ForegroundColor Yellow\n    Write-Host \"ğŸ”§ å»ºè®®: ä¿®å¤å‰©ä½™é—®é¢˜åé‡æ–°æµ‹è¯•\" -ForegroundColor Yellow\n} else {\n    Write-Host \"âš ï¸  çŠ¶æ€: éœ€è¦è¿›ä¸€æ­¥ä¿®å¤\" -ForegroundColor Red\n    Write-Host \"ğŸ› ï¸  å»ºè®®: æ£€æŸ¥ä»£ç ä¿®æ”¹å¹¶é‡æ–°éªŒè¯\" -ForegroundColor Red\n}\n\nWrite-Host \"\"\nWrite-Host \"ä¿®å¤æ‘˜è¦:\" -ForegroundColor Cyan\nWrite-Host \"- âœ… API å“åº”è§£æ: æ”¯æŒå¤šæ ¼å¼åæ ‡è§£æ\" -ForegroundColor White\nWrite-Host \"- âœ… å¤‡ç”¨æ•°æ®ç”Ÿæˆ: 10ä¸ªåŸå¸‚åæ ‡åº“\" -ForegroundColor White\nWrite-Host \"- âœ… æµ‹è¯•äº‹ä»¶åˆ›å»º: 8ä¸ªæµ‹è¯•åŸå¸‚åæ ‡\" -ForegroundColor White\nWrite-Host \"- âœ… é™çº§ç­–ç•¥: é™æ€åæ ‡é…ç½®\" -ForegroundColor White\nWrite-Host \"- âœ… é”™è¯¯å¤„ç†: å®Œæ•´çš„å¼‚å¸¸å¤„ç†æœºåˆ¶\" -ForegroundColor White\nWrite-Host \"- âœ… æ—¥å¿—è®°å½•: è¯¦ç»†çš„è°ƒè¯•ä¿¡æ¯\" -ForegroundColor White\n\nWrite-Host \"\"\nWrite-Host \"é¢„æœŸæ•ˆæœ:\" -ForegroundColor Cyan\nWrite-Host \"ğŸŒ æ–°åˆ›å»ºçš„äº‹ä»¶å°†åŒ…å«å‡†ç¡®çš„ç»çº¬åº¦åæ ‡\" -ForegroundColor White\nWrite-Host \"ğŸ“ æ¨¡æ‹Ÿäº‹ä»¶ä½¿ç”¨çœŸå®åŸå¸‚çš„åæ ‡æ•°æ®\" -ForegroundColor White\nWrite-Host \"ğŸ—ºï¸  æ”¯æŒå¤šç§åæ ‡æ ¼å¼çš„è‡ªåŠ¨è§£æ\" -ForegroundColor White\nWrite-Host \"ğŸ“Š æä¾›è¯¦ç»†çš„è§£ææ—¥å¿—å’Œé”™è¯¯å¤„ç†\" -ForegroundColor White\nWrite-Host \"ğŸ”„ ä¸åœ°ç†ä¿¡æ¯å¢å¼ºæœåŠ¡ååŒå·¥ä½œ\" -ForegroundColor White\n\nWrite-Host \"\"\nWrite-Host \"æ„Ÿè°¢ä½¿ç”¨åæ ‡ä¿®å¤éªŒè¯è„šæœ¬ï¼\" -ForegroundColor Green"
}
</invoke>